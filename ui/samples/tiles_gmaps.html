<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <title>INRIX Tiles on Google Maps</title>
    <!-- please specify your google maps api in the url : &key=YOUR_API_KEY -->
    <script
      src="https://maps.googleapis.com/maps/api/js?v=weekly&callback=initMap"
      async
    ></script>
    <script src="../core/inrix.sample.layer.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script type="text/javascript" src="../client-config.js"></script>
    <script type="text/javascript" src="../util/token.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/shared-styles.css" />
  </head>

  <body>
    <h2 class="title">Tiles Google Map</h2>
    <div class="description">
      Sample description text here. Sample description text here. Sample
      description text here. Sample description text here. Sample description
      text here. Sample description text here. Sample description text here.
      Sample description text here. Sample description text here. Sample
      description text here. Sample description text here. Sample description
      text here. Sample description text here. Sample description text here.
    </div>
    <div class="map-container">
      <div id="map"></div>
    </div>

    <script>
      const SF = { lat: 37.764832, lng: -122.443079 };

      async function initMap() {
        // Access token management would be handled on the backend of your server, it would get / renew / reuse the token as necessary
        try {
          this.accessToken = await getToken();
        } catch (e) {
          alert("network error: cannot get access token");
        }

        // setting up San Francisco boundaries:
        const strictBounds = new google.maps.LatLngBounds(
          new google.maps.LatLng(37.71, -122.53),
          new google.maps.LatLng(37.81, -122.35)
        );

        const center = new google.maps.LatLng(SF);
        const mapOptions = {
          center: center,
          zoom: 15,
          mapTypeId: google.maps.MapTypeId.ROADMAP,
          restriction: {
            latLngBounds: strictBounds,
            strictBounds: true,
          },
        };

        const map = new google.maps.Map(
          document.getElementById("map"),
          mapOptions
        );
        const traffic = new InrixTileLayer(map, this.accessToken.token, config);
        traffic.show();
      }
    </script>
  </body>
</html>
